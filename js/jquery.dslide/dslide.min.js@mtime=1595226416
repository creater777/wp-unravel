$.fn.dslide=function(e){return this.each(function(){function a(){$.fn.dvideo?(o.children("a.video-image").each(function(){var e=$(this),a=e.parent().addClass("opacity-0");a.find(".dcore-zoom-cover")&&(a=a.find(".dcore-zoom-cover")),a.hasClass("dvideo-image-installed")||$.dvideoImage(e.attr("href"),function(t){a.css("background-image","url("+t+")").addClass("dvideo-image-installed"),e.parent().imagesLoaded({background:!0},function(){e.parent().addClass("opacity-1")})})}),o.children("a.video").unbind("click").click(function(e){e.preventDefault();var a=$(this),t=a.attr("href"),d=$("<div />").addClass("dslide-video").appendTo(s.trigger("pause"));g.fadeOut(),C.fadeOut(),$("<div />").addClass("dslide-video-view").appendTo(d).dvideo(t,!0).hide().fadeIn(),$("<a />").addClass("dslide-video-close no-pjax").appendTo(d).click(function(e){e.preventDefault(),d.fadeOut(function(){d.remove()}),g.fadeIn(),C.fadeIn()})})):o.children("a.video").attr("target","_blank")}function t(e){if(!l){if("panend"!=P)return P="pan",void i(e);P="panstart",l=!0,r.dissolve||(s.trigger("pause"),T=o.filter(".dslide-current-target"),D=T.prev(),0==D.length&&(D=$("<div />").addClass("dslide-item dslide-item-tmp").prependTo(p)),D.show(),w=T.next(),0==w.length&&(w=$("<div />").addClass("dslide-item dslide-item-tmp").appendTo(p)),w.show(),p.addClass("dslide-slider-ing").css("left","-100%"))}}function d(e){if(("panstart"==P||"pan"==P)&&(P="pan",Math.abs(e.deltaX)>Math.abs(e.deltaY)&&(e.preventDefault(),!r.dissolve))){var a=e.deltaX/u.width()*100-100;p.css("left",a+"%")}}function i(e){if("pan"==P)if(P="panend",e.preventDefault(),r.dissolve)l=!1,e.deltaX>0?k.click():y.click();else{var t=e.deltaX>0?D:w,d=!1;(t.hasClass("dslide-item-tmp")||Math.abs(u.offset().left-T.offset().left)<u.width()/5)&&(d=!0);var i=r.slideDuration,n=Math.abs(e.deltaX/e.velocityX);if(n<100&&(n=100),n<r.slideDuration&&(i=n),r.dynamicHeight){var c=t.attr("data-width")?parseInt(t.attr("data-width")):t.outerWidth(),h=t.attr("data-height")?parseInt(t.attr("data-height")):t.outerHeight();s.animate({paddingBottom:h/c*100+"%"},{queue:!1,duration:r.slideDuration})}p.animate({left:d?"-100%":e.deltaX>0?"0":"-200%"},{duration:i,complete:function(){if(D.hasClass("dslide-item-tmp")&&D.remove(),w.hasClass("dslide-item-tmp")&&w.remove(),d)o.not(T).hide();else{var e=t.data("dslide-page");e&&e.trigger("mark-current"),o.not(t.addClass("dslide-current-target")).removeClass("dslide-current-target"),r.reloadChange&&(T.html(T.html()),a()),o.not(t).hide()}p.removeClass("dslide-slider-ing").css("left","0"),l=!1,r.onslidecomplete(s)}})}}function n(){if(0!=r.playInterval){var e=g.find(".dslide-current").next().children("a");0==e.length&&(e=b.find("a:first")),r.stopWhenHover&&s.hasClass("dslide-hover")||(e.trigger("run"),S&&clearTimeout(S),S=setTimeout(n,r.playInterval))}}var s=$(this);if(!s.hasClass("dslide-installed")){var r=$.extend(!0,{paginationParent:null,paginationCounter:!1,paginationCounterParent:null,randomStart:!1,startIndex:0,reloadChange:!1,buttonsWrapper:!0,hideButtonsOnMouseOut:!1,hidePaginationOnMouseOut:!1,stopWhenHover:!1,stopWhenSlide:!0,slideDuration:600,dissolve:!1,dynamicHeight:!1,loop:!0,backgroundSize:"cover",onslide:function(e){},onslidecomplete:function(e){},playInterval:0},e);s.attr("data-dslide-pagination-parent")&&(r.paginationParent=$(s.attr("data-dslide-pagination-parent"))),s.attr("data-dslide-pagination-counter")&&(r.paginationCounter="true"==s.attr("data-dslide-pagination-counter")),s.attr("data-dslide-pagination-counter-parent")&&(r.paginationCounterParent=$(s.attr("data-dslide-pagination-counter-parent"))),s.attr("data-dslide-random-start")&&(r.randomStart="true"==s.attr("data-dslide-random-start")),s.attr("data-dslide-start-index")&&(r.startIndex=parseInt(s.attr("data-dslide-start-index"))),s.attr("data-dslide-reload-change")&&(r.reloadChange="true"==s.attr("data-dslide-reload-change")),s.attr("data-dslide-buttons-wrapper")&&(r.buttonsWrapper="true"==s.attr("data-dslide-buttons-wrapper")),s.attr("data-dslide-hide-buttons-on-mouse-out")&&(r.hideButtonsOnMouseOut="true"==s.attr("data-dslide-hide-buttons-on-mouse-out")),s.attr("data-dslide-hide-pagination-on-mouse-out")&&(r.hidePaginationOnMouseOut="true"==s.attr("data-dslide-hide-pagination-on-mouse-out")),s.attr("data-dslide-stop-when-hover")&&(r.stopWhenHover="true"==s.attr("data-dslide-stop-when-hover")),s.attr("data-dslide-stop-when-slide")&&(r.stopWhenSlide="true"==s.attr("data-dslide-stop-when-slide")),s.attr("data-dslide-slide-duration")&&(r.slideDuration=parseInt(s.attr("data-dslide-slide-duration"))),s.attr("data-dslide-dissolve")&&(r.dissolve="true"==s.attr("data-dslide-dissolve")),s.attr("data-dslide-dynamic-height")&&(r.dynamicHeight="true"==s.attr("data-dslide-dynamic-height")),s.attr("data-dslide-loop")&&(r.loop="true"==s.attr("data-dslide-loop")),s.attr("data-dslide-background-size")&&(r.backgroundSize=s.attr("data-dslide-background-size")),s.attr("data-dslide-play-interval")&&(r.playInterval=parseInt(s.attr("data-dslide-play-interval")));var l=!1;s.addClass("dslide"),s.hover(function(){s.addClass("dslide-hover")},function(){s.removeClass("dslide-hover")});var o=s.children().addClass("dslide-item");r.dissolve&&o.addClass("dslide-item-dissolve");var u=$("<div />").addClass("dslide-zone").appendTo(s),p=$("<div />").addClass("dslide-slider").appendTo(u).append(o);if(r.dynamicHeight){var c=o.filter(":first"),h=c.attr("data-width")?parseInt(c.attr("data-width")):c.outerWidth(),f=c.attr("data-height")?parseInt(c.attr("data-height")):c.outerHeight();s.css("padding-bottom",f/h*100+"%")}var g=$("<div />");r.paginationParent?g.appendTo(r.paginationParent):g.appendTo(s),g.addClass("dslide-pagination");var v=$("<div />");if(r.paginationCounter){v.addClass("dslide-pagination-counter").appendTo(r.paginationCounterParent?r.paginationCounterParent:s);$("<span />").addClass("current").appendTo(v);$("<span />").addClass("dslide-pc-divider").text("/").appendTo(v);var m=$("<span />").addClass("total").text(o.length).appendTo(v);"1"==m.text()&&v.remove()}var C,b=$("<ul />").appendTo(g);r.buttonsWrapper&&(C=$("<div />").addClass("dslide-buttons").appendTo(s),o.length<=1&&C.css("visibility","hidden"));var k=$('<a href="#"><span class="fa fa-fw fa-angle-left"></span></a>').click(function(e){var a=g.find(".dslide-current").prev().children("a");0==a.length&&(a=g.find("a:last")),a.click(),e.preventDefault()}).appendTo(r.buttonsWrapper?C:s).addClass("dslide-prev").each(function(){"undefined"!=typeof DD_belatedPNG&&DD_belatedPNG.fixPng(this)}),y=$('<a href="#"><span class="fa fa-fw fa-angle-right"></span></a>').click(function(e){var a=g.find(".dslide-current").next().children("a");0==a.length&&(a=g.find("a:first")),a.click(),e.preventDefault()}).appendTo(r.buttonsWrapper?C:s).addClass("dslide-next").each(function(){"undefined"!=typeof DD_belatedPNG&&DD_belatedPNG.fixPng(this)}),I={target:s.get(0),ing:!1,x:0,y:0,delta:0};if("undefined"!=typeof Hammer){var x=new Hammer.Manager(s.get(0));x.add(new Hammer.Pan);var T,D,w,P="panend";x.on("panstart",t).on("pan",d).on("panend",i)}r.buttonsWrapper&&r.hideButtonsOnMouseOut&&(s.hover(function(){C.animate({opacity:"1"},{queue:!1})},function(){C.animate({opacity:"0"},{queue:!1})}),C.css("opacity","0"),k.hide(),y.hide());var W=1;if(r.dissolve&&o.css({opacity:"0","z-index":"0"}),o.each(function(){var e=$(this).data("dslide-index",W),t=$("<li />").attr("data-dslide-index",W).appendTo(b),d=$('<a href="#"></a>'),i=e.attr("data-dslide-thumbnail");i&&(g.removeClass("dslide-pagination").addClass("dslide-thumbnails"),b.parent().hasClass("dslide-thumbnails-inner")||b.wrap('<div class="dslide-thumbnails-inner" />'),d.css({backgroundImage:"url("+i+")"})),e.data("dslide-page",d),d.click(function(e){e.preventDefault(),r.stopWhenHover||s.trigger("pause"),r.stopWhenSlide&&s.trigger("pause"),$(this).trigger("run")}).data("dslide-target",e).bind("run",function(t){var d=s.find(".dslide-current-target");if(!(d.length>0&&e.length>0&&d.get(0)==e.get(0)||l)){l=!0;var i=0==d.length||d.data("dslide-index")<e.data("dslide-index");s.data("isnext",i);var n;r.dissolve||(n=i?d.prev():d.next(),0==n.length&&(n=$("<div />").addClass("dslide-item dslide-item-tmp"),i?n.prependTo(p):n.appendTo(p)));var u=d.html();if(o.not(e.addClass("dslide-current-target")).removeClass("dslide-current-target"),r.dynamicHeight){var c=e.attr("data-width")?parseInt(e.attr("data-width")):e.outerWidth(),h=e.attr("data-height")?parseInt(e.attr("data-height")):e.outerHeight();setTimeout(function(){s.animate({paddingBottom:h/c*100+"%"},{queue:!1,duration:r.slideDuration})},1)}if(e.find(".background-is-bright").length>0?s.removeClass("background-is-dark").addClass("background-is-bright"):e.find(".background-is-dark").length>0?s.removeClass("background-is-bright").addClass("background-is-dark"):s.removeClass("background-is-bright").removeClass("background-is-dark"),r.dissolve?(o.not(e).css("z-index","0"),r.onslide(s),e.show().css({backgroundSize:r.backgroundSize,opacity:"0","z-index":"1"}).animate({opacity:"1"},{complete:function(){r.reloadChange&&(d.html(u),a()),o.not(e).hide(),l=!1,r.onslidecomplete(s)},queue:!1,duration:r.slideDuration})):(o.not(e.show().css({backgroundSize:r.backgroundSize})).not(d).hide(),n.show().css({backgroundSize:r.backgroundSize}),p.addClass("dslide-slider-ing"),I.ing||p.css("left","-100%"),r.onslide(s),p.animate({marginLeft:0,left:d.length>0?i?"-200%":"0":"-100%"},{complete:function(){r.reloadChange&&(d.html(u),a()),r.dissolve?o.not(e).hide():(n.hasClass("dslide-item-tmp")&&n.remove(),e.hasClass("dslide-item-appended")&&e.removeClass("dslide-item-appended").prependTo(p),e.hasClass("dslide-item-prepended")&&e.removeClass("dslide-item-prepended").appendTo(p),o.not(e).hide(),p.css({marginLeft:"0",left:"0"}),p.removeClass("dslide-slider-ing")),l=!1,r.onslidecomplete(s)},queue:!1,duration:d.length>0?r.slideDuration:0})),$(this).trigger("mark-current"),g.hasClass("dslide-thumbnails")){var f=g.find(".dslide-thumbnails-inner"),v=g.find(".dslide-current"),m=v.offset().left+v.outerWidth()/2-b.offset().left-g.outerWidth()/2;f.animate({scrollLeft:m})}}}).bind("mark-current",function(e){b.find("li").not($(this).parent().addClass("dslide-current")).removeClass("dslide-current"),r.paginationCounter&&v.find(".current").text(b.find(".dslide-current").attr("data-dslide-index")),this==b.find("a:first").get(0)?r.loop?k.fadeIn():k.fadeOut():k.fadeIn(),this==b.find("a:last").get(0)?r.loop?y.fadeIn():y.fadeOut():y.fadeIn()}).text(W).appendTo(t).each(function(){"undefined"!=typeof DD_belatedPNG&&DD_belatedPNG.fixPng(this)}).focus(function(){$(this).blur()}),W++}).hide(),o.length<2&&(k.remove(),y.remove(),g.hide()),r.hidePaginationOnMouseOut&&(g.css("opacity","0"),s.hover(function(){g.animate({opacity:"1"},{queue:!1})},function(){g.animate({opacity:"0"},{queue:!1})})),b.children("li:first").addClass("first"),b.children("li:last").addClass("last"),s.parent().find("a").focus(function(){$(this).blur()}),r.randomStart){var O=b.find("a"),z=Math.floor(Math.random()*O.length),H=r.slideDuration;r.slideDuration=0,setTimeout(function(){$(O.get(z)).trigger("run"),r.slideDuration=H},1)}else{var O=b.find("a");O.length<=r.startIndex&&(r.startIndex=0),$(O.get(r.startIndex)).trigger("run")}if(r.playInterval>0){var S=null;r.stopWhenHover&&s.mouseout(function(){S&&clearTimeout(S),S=setTimeout(n,r.playInterval)}),S=setTimeout(n,r.playInterval),s.bind("pause",function(){r.playInterval=0,S&&clearTimeout(S)}),s.bind("play",function(){s.attr("data-dslide-play-interval")&&(r.playInterval=parseInt(s.attr("data-dslide-play-interval")),n())})}s.addClass("dslide-installed")}})},$(document).bind("dofirst",function(e,a){$(a).find(".dslide").dslide()});