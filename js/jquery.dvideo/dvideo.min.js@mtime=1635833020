$.dvideoParse=function(e){var t=/^(http|https):\/\/[w]{0,3}[\.]{0,1}(vimeo\.com|youtube\.com|youtu\.be)\/([^\/]+)/.exec(e),i={type:"",vid:""};if(!t||t.length<4)return!1;switch(i.type=t[2],i.vid=t[3],i.type){case"youtube.com":case"youtu.be":i.type="youtube";break;case"vimeo.com":i.type="vimeo"}if("youtube"==i.type){if(!(t=/^watch\?v=([a-zA-Z0-9_-]+)/.exec(i.vid))||t.length<2)return i;i.vid=t[1]}return i},$.dvideoImage=function(e,i){var t=$.dvideoParse(e);if(!t)return!1;switch(t.type){case"youtube":i("https://img.youtube.com/vi/"+t.vid+"/mqdefault.jpg");break;case"vimeo":$.dget("https://vimeo.com/api/v2/video/"+t.vid+".json?callback=?",function(e){var t=!1;0<e.length&&(t=e[0].thumbnail_large),i(t)})}},$.fn.dvideo=function(e,t,i,a,o,d){var n=this;e=$.trim(e);var r=$.dvideoParse(e);if(!r)return this;if("youtube"==r.type&&("undefined"==typeof YT||void 0===YT.Player)){var s=document.createElement("script");s.src="https://www.youtube.com/iframe_api";var c=document.getElementsByTagName("script")[0];return c.parentNode.insertBefore(s,c),$.dvideoQueue.push(function(){n.dvideo(e,t,i,a,o,d)}),this}var u=$("<div />").addClass("dvideo-view").appendTo(n),v=$("<div />").addClass("dvideo-target").appendTo(u);v.css("visibility","hidden");var p=9/16;switch(n.attr("data-ratio")&&(p=parseFloat(n.attr("data-ratio"))),u.css("padding-bottom",100*p+"%"),r.type){case"youtube":var l=$("<div />").appendTo(v),m=new YT.Player(l.get(0),{videoId:r.vid,playerVars:{playlist:r.vid,rel:0,playsinline:1,wmode:"transparent",controls:o?0:1,showinfo:0,modestbranding:0,loop:i?1:0,fs:1,autohide:1},events:{onStateChange:function(e){"force"===t&&e.data==YT.PlayerState.PAUSED&&setTimeout(function(){m.playVideo()},1e3)},onReady:function(e){d&&m.seekTo(d,!0),t&&m.playVideo(),applyPlyr(v),"function"==typeof a&&a(v,e.target),v.css("visibility","visible")}}});break;case"vimeo":$.dget("https://vimeo.com/api/v2/video/"+r.vid+".json?callback=?",function(e){u.css("padding-bottom",e[0].height/e[0].width*100+"%"),v.attr("data-width",e[0].width),v.attr("data-height",e[0].height),v.html('<iframe src="https://player.vimeo.com/video/'+e[0].id+"?title=0&amp;byline=0&amp;portrait=0&amp;loop="+(i?"1":"0")+"&amp;autoplay="+(t?"1":"0")+'" width="100%" height="100%" frameborder="0" webkitallowfullscreen="1" mozallowfullscreen="1" allowfullscreen="1" allow="autoplay; encrypted-media"></iframe>'),"function"==typeof a&&a(v),v.css("visibility","visible")})}return this},$.fn.dvideoTrigger=function(){return this.each(function(){var e=$(this).empty().addClass("dvideo-trigger");$("<span />").addClass("dvideo-play").appendTo(e);$("<img />").appendTo(e).dvideoImage(e.attr("href"))})},$(document).bind("dofirst",function(e,t){$(t).find(".dvideo").each(function(){$(this).dvideo($(this).attr("data-url"))}),$(t).find("[data-dvideo-image]").each(function(){var t=$(this);$.dvideoImage(t.attr("data-dvideo-image"),function(e){e&&(e=$.trim(e),t.css({backgroundImage:"url("+e+")"}).imagesLoaded({background:!0},function(){t.closest(".opacity-0").addClass("opacity-1")}))})})});