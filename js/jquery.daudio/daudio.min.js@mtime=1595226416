$.fn.daudio=function(d){return $(this).each(function(){function a(d){var a=parseInt(d),t=Math.floor(a/60);return a%=60,t<10&&(t="0"+t),a<10&&(a="0"+a),t+":"+a}function t(){f.text(a(i.duration))}function n(){f.text(a(i.currentTime))}var i=($.extend(!0,{},d),this);$(i).wrap($("<div />").addClass("daudio-wrap"));var e=$(i).parent(),o=$("<div />").addClass("daudio-outer").appendTo(e),u=$("<div />").addClass("daudio-buttons").appendTo(o),r=$("<div />").addClass("daudio-buttons-inner").appendTo(u),s=$("<button />").attr("type","button").addClass("daudio-play").appendTo(r),p=$("<button />").attr("type","button").addClass("daudio-pause").appendTo(r),c=$("<div />").addClass("daudio-progress").appendTo(o),l=$("<div />").addClass("daudio-progress-bar").appendTo(c),f=$("<div />").addClass("daudio-time").text("00:00").appendTo(o);s.click(function(d){d.preventDefault(),i.play(),e.addClass("daudio-playing"),$(".daudio-wrap .daudio-pause").not(p).click()}),p.click(function(d){d.preventDefault(),i.pause(),e.removeClass("daudio-playing")}),c.click(function(d){d.preventDefault(),s.click();var a=d.offsetX/c.outerWidth();i.currentTime=i.duration*a}),i.addEventListener("timeupdate",function(){var d=100*(i.currentTime/i.duration);l.css("width",d+"%"),n()},!1),i.addEventListener("canplaythrough",t,!1),i.addEventListener("ended",function(){p.click()},!1),o.dofirst()})},$(document).bind("dofirst",function(d,a){$(a).find(".daudio").each(function(){$(this).daudio()})});