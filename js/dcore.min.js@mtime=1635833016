$.each(["dget","dpost"],function(_i,method){$[method]=$.dpost=function(url,data,success,dataType,error){"function"==typeof data&&(error=dataType,dataType=success,success=data,data=void 0),"string"==typeof success&&(error=dataType,dataType=success,success=void 0),"function"==typeof dataType&&(error=dataType,dataType=void 0),"function"!=typeof success&&(success=function(t){t.error&&$.dalert(t.error)}),"string"!=typeof dataType&&(dataType="json"),"function"!=typeof error&&(error=function(t){console.log(t.responseText)});var param={url:url,type:"dpost"==method?"POST":"GET",dataType:dataType,data:data,success:success,error:error},funcName;"dget"==method&&url.match(/\=\?$/)&&(funcName="_"+Math.random().toString().replace(/^0\./,""),param.url=url.replace(/\=\?$/,"="+funcName),param.type="GET",param.dataType="text",param.success=function(res){eval("var "+funcName+"=success;"+res)}),$.ajax(param)}}),$.dcoreSubmitResult=function(t,e){t.error?$.dtoast('<span class="fa fa-frown-o"></span>&nbsp;&nbsp;'+t.error):t.message?$.dtoast('<span class="fa fa-smile-o"></span>&nbsp;&nbsp;'+t.message):t.redirect&&(1==e?location.href=t.redirect:$.pjaxRedirect(t.redirect))},$.dcorePostResult=function(t,e){var a=t.find('button[type="submit"]');return a.prop("disabled")||(a.prop("disabled",!0),$.post(t.attr("action"),t.serialize(),function(t){a.prop("disabled",!1),$.dcoreSubmitResult(t,e)},"json")),!1},$(document).bind("dofirst",function(t,e){$(e).find("select.dcore-set, input.dcore-set, textarea.dcore-set").change(function(){var t=$(this),e={};e[t.attr("name")]=t.val(),$.post(t.attr("data-url")+"/rules/validation_rules_"+t.attr("name"),e,function(t){t.error?$.dtoast('<span class="fa fa-frown-o"></span>&nbsp;&nbsp;'+t.error,null,!0):t.message&&$.dtoast('<span class="fa fa-smile-o"></span>&nbsp;&nbsp;'+t.message,null,!0),$.dtoast('<span class="fa fa-smile-o"></span>&nbsp;&nbsp;저장 되었습니다.',null,!0)},"json")}),$(e).find("button.dcore-notify-order-status").each(function(t){var e,a,n=$(this);n.attr("data-depend-on")&&n.attr("data-enable-on")&&(e=$(n.attr("data-depend-on")),a=n.attr("data-enable-on").split(","),e.bind("enable-me",function(){n.prop("disabled",$.inArray(e.val(),a)<0)}).change(function(){e.trigger("enable-me")}).trigger("enable-me"))}).click(function(t){t.preventDefault();var e=$(this);e.attr("data-url");e.prop("disabled",!0),$.post(e.attr("data-url"),function(t){e.prop("disabled",!1),t.error?$.dtoast('<span class="fa fa-frown-o"></span>&nbsp;&nbsp;'+t.error,null,!0):t.message&&$.dtoast('<span class="fa fa-smile-o"></span>&nbsp;&nbsp;'+t.message,null,!0)},"json")}),$(e).find("a.dcore-expected-redirection").click(function(t){t.preventDefault();var e=$(this).attr("href"),a=e.split("?");$.post(1<a.length?a[0]:e,1<a.length?a[1]:"",function(t){$.dcoreSubmitResult(t)},"json")}),$(e).find(".dcore-body table").each(function(){$(this).addClass("bordered responsive-table-")}),$(e).find('.dcore-body:not([contenteditable="true"]) table').each(function(){$(this).wrap('<div class="table-wrap" />')}),$(e).find("form#f-posts-search").submit(function(){var t=$(this);return $.post(t.attr("action"),t.serialize(),function(t){$.pjaxRedirect(t.redirect)},"json"),!1}),$(e).find(".dcore-tabs").each(function(){var n,t,s=$(this).find(".dcore-tab a");0<s.length&&s.filter(":first").attr("href").match(/^#/)&&(n=$(s.filter(":first").attr("href")).parent().children(),s.click(function(t){t.preventDefault();var e=$(this),a=n.filter(e.attr("href"));n.not(a.removeClass("hide")).addClass("hide"),s.not(e.addClass("active")).removeClass("active")}),0<(t=s.filter(".active")).length?t.click():s.filter(":first").click())}),$(e).find(".dcore-post-related").each(function(){var n=$(this),r=n.find(".post-related-items"),o=n.attr("data-baseurl"),s=n.find(".post-related-keyword"),i=$("#"+s.attr("data-activates"));s.dropdown({constrainWidth:!1,belowOrigin:!0});var e=null;function d(e){var a=$("<div />").addClass("dsave-item col s12 m6").attr({id:"item-"+e.uid}).appendTo(r),t=$("<div />").addClass("card").appendTo(a),n=$("<div />").addClass("card-content").appendTo(t);t.css({cursor:"move"}),e.post&&e.post.featured_image&&$("<div />").addClass("right circle").css({display:"block",width:30,height:30,marginTop:-3,backgroundColor:"#ebebeb",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center top",backgroundImage:"url("+e.post.featured_image.furl+")"}).appendTo(n);var s=$("<span />").css({display:"inline-block",maxWidth:"calc(100% - 80px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"}).html(e.post?e.post.title+(e.post.subtitle?"&nbsp;<small><em>"+e.post.subtitle+"&nbsp;</em><small>":""):"").appendTo(n);s.append("&nbsp;&nbsp;"),$("<small />").text(e.post?e.post.price_sale:"").appendTo(s),s.append("&nbsp;&nbsp;"),$("<small />").text(e.post?e.post.time:"").appendTo(s),s.tooltip({content:s.text()}),$("<button />").attr("type","button").addClass("dsave-remove btn btn-floating waves-effect waves-light").html('<span class="fa fa-times"></span>').appendTo(t).click(function(t){t.preventDefault(),$.post(o+"/"+e.uid+"/delete"),a.remove()})}s.keyup(function(){var t;t=s.val(),e&&clearTimeout(e),e=setTimeout(function(){$.get(o+"/search",{keyword:t},function(t){i.empty(),$(t).each(function(){var t,e,a=this;"true"!=n.attr("data-include-me")&&a.uid==n.attr("data-uid")||(t=$("<li />").appendTo(i),e=$("<a />").attr("href","#post-"+a.uid).addClass("no-pjax").appendTo(t),a.featured_image&&$("<span />").addClass("right circle").css({display:"block",width:30,height:30,marginTop:-3,marginLeft:10,backgroundColor:"#ebebeb",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center top",backgroundImage:"url("+a.featured_image.furl+")"}).appendTo(e),$("<span />").html(a.title+(a.subtitle?" <small><em>"+a.subtitle+"&nbsp;</em></small>":"")).appendTo(e),e.append("&nbsp;&nbsp;"),$("<small />").text(a.price_sale).appendTo(e),e.append("&nbsp;&nbsp;"),$("<small />").text(a.time).appendTo(e),e.click(function(t){t.preventDefault(),$.post(o+"/create",{uid_post:a.uid},function(t){t.error?$dtoast(t.error):t.uid&&(d({uid:t.uid,post:a}),s.dropdown("close"),r.trigger("update-order"))},"json")}))}),s.dropdown("open")},"json")},500)}),r.sortable({handle:".card",items:"> .dsave-item",update:function(){r.trigger("update-order")}}).bind("update-order",function(){var t=$(this).sortable("serialize");$.post(o+"/orders",t,function(t){"__OK__"==t||$.dtoast(t)},"text")}),$.get(o,function(t){$(t.rows).each(function(){d(this)})},"json")}),$(e).find("button.dcore-cancel-order").click(function(t){t.preventDefault();var e=$(this);$.dconfirm(e.attr("data-confirm"),function(){e.prop("disabled",!0),$.post(e.attr("data-url"),function(t){e.prop("disabled",!1),$.dcoreSubmitResult(t)},"json")})}),$(e).find(".no-pjax-animation").click(function(t){$("html").addClass("no-pjax-animated")}),$(e).find(".dcore-cart-count-outer").bind("update-cart",function(t,a){var n=$(this);n.parent().mouseover(function(){n.removeClass("active-")}),n.mouseover(function(){n.removeClass("active-")}),$.get("/api/cart/total/html",function(t){var e=$("<div />").html(t).find(".dcore-cart-count-outer");0<e.length&&(n.html(e.html()),a&&n.addClass("active-").clickOutside(function(){n.removeClass("active-")}))},"html")})});